# Алгоритм классификации типа дорожного покрытия

Алгоритм классификации типа дорожного покрытия – это ансамбль из нескольких сверточных нейронных сетей, состоящий из нейронной сети, предназначенной для определения типа дорожного покрытия, и пяти дочерних алгоритмов, направленных на определение кондиций конкретного типа дорожного покрытия. Под кондициями дорожного покрытия подразумевается его состояние при различных погодных условиях: сухое, влажное и мокрое. За исключением снежного дорожного покрытия, при снежном дорожном покрытии классы меняются на лед, рыхлый свежий снег, тающий снег.
Головная нейронная сеть, направленная на определение типа дорожного покрытия — это сверточная нейронная сеть, состоящая из 20 слоев с переходной функцией активации ReLU. На выходном слое функция активации softmax. Функция потерь binary crossentropy. В качестве оптимизатора выбран алгоритм улучшенного стохастического градиентного бустинга Adam с частотой обработки learning rate 0.00001. На вход поступает цветное изображение размером 356x236. 
 
Дочерняя нейронная сеть, направленная на определение состояния бетонного дорожного покрытия – это сверточная нейронная сеть, состоящая из 22 слоев с переходной функцией активации ReLU. На выходном слое функция активации softmax. Функция потерь binary crossentropy. В качестве оптимизатора выбран алгоритм улучшенного стохастического градиентного бустинга Adam с частотой обработки learning rate 0.00001. На вход поступает цветное изображение размером 356x236. Архитектура нейросети представлена на рисунке 76.
 
 Последующие дочерние нейронные сети, направленные на определение состояния асфальтированного, гравийного, грунтового и снежного дорожных покрытий имеют идентичную архитектуру за исключением индивидуально настроенного показателя частоты работы оптимизатора. 
Данные алгоритмы представляют собой сверточную нейронную сеть, состоящую из 25 слоев с переходной функцией активации Swish. На выходном слое функция активации softmax. Функция потерь categorical crossentropy. В качестве оптимизатора выбран алгоритм улучшенного стохастического градиентного бустинга Adam с индивидуально частотой обработки learning rate. На вход поступает цветное изображение размером 356x236. 

Для обучения алгоритма классификации дорожного движения использовался откорректированный набор данных RSCD [67]. Исходные снимки сделаны USB-камерой. Фотоснимки, размером 360*240, были сделаны с января по июль 2022 года в Пекине и охватили около 600 километров дорог. Дорожный материал состоит из асфальта, бетона, грунта, гравия и снежного покрытия. Дорожные условия делятся сухое покрытие, влажное и мокрое. Для снежного типа – на лед, рыхлый снег, талый снег. Всего было получено 15 объединенных классов.Всего для обучения и дообучения алгоритма было использовано более 50 000 изображений.

В качестве показателя эффективности работы алгоритма использовалась метрика wF1-score. Для оценки точности использовались тестовая и валидационная выборки, состоящие из изображений, которые нейросеть ранее не видела. 

Модель | Metric_test
------ | ------
Модель классификации типа дорожного покрытия	| 0,8069
Классификация асфальтированного покрытия	| 0,8829
Классификация бетонного покрытия	| 0,8381
Классификация гравийного покрытия	| 0,9328
Классификация снежного покрытия	| 0,9148
Классификация грунтового покрытия	| 0,8952

